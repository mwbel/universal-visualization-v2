# ä¸‡ç‰©å¯è§†åŒ– - å‰ç«¯ç°ä»£åŒ–æ–¹æ¡ˆ

## ğŸ¯ æŠ€æœ¯é€‰å‹æ¨è

### 1. æ¡†æ¶é€‰æ‹©ï¼šVue.js 3 + TypeScript

#### é€‰æ‹©ç†ç”±ï¼š
- âœ… **å­¦ä¹ æ›²çº¿å¹³ç¼“**ï¼šä»åŸç”ŸJSå‡çº§ç›¸å¯¹å®¹æ˜“
- âœ… **å“åº”å¼ç³»ç»Ÿ**ï¼šå®Œç¾é€‚é…æ•°æ®å¯è§†åŒ–åœºæ™¯
- âœ… **ç”Ÿæ€ç³»ç»Ÿæˆç†Ÿ**ï¼šä¸°å¯Œçš„å›¾è¡¨å’ŒUIç»„ä»¶åº“
- âœ… **TypeScriptæ”¯æŒ**ï¼šç±»å‹å®‰å…¨ï¼Œæé«˜ä»£ç è´¨é‡
- âœ… **æ€§èƒ½ä¼˜ç§€**ï¼šç¼–è¯‘ä¼˜åŒ–ï¼Œè¿è¡Œæ—¶é«˜æ•ˆ

### 2. é¡¹ç›®ç»“æ„è®¾è®¡

```
frontend/
â”œâ”€â”€ public/
â”‚   â”œâ”€â”€ index.html
â”‚   â””â”€â”€ favicon.ico
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ api/              # APIæ¥å£å±‚
â”‚   â”‚   â”œâ”€â”€ visualization.ts
â”‚   â”‚   â”œâ”€â”€ template.ts
â”‚   â”‚   â””â”€â”€ auth.ts
â”‚   â”œâ”€â”€ components/       # é€šç”¨ç»„ä»¶
â”‚   â”‚   â”œâ”€â”€ common/
â”‚   â”‚   â”œâ”€â”€ charts/
â”‚   â”‚   â””â”€â”€ forms/
â”‚   â”œâ”€â”€ views/           # é¡µé¢ç»„ä»¶
â”‚   â”‚   â”œâ”€â”€ Home.vue
â”‚   â”‚   â”œâ”€â”€ Editor.vue
â”‚   â”‚   â”œâ”€â”€ Gallery.vue
â”‚   â”‚   â””â”€â”€ Templates.vue
â”‚   â”œâ”€â”€ stores/          # çŠ¶æ€ç®¡ç†
â”‚   â”‚   â”œâ”€â”€ user.ts
â”‚   â”‚   â”œâ”€â”€ visualization.ts
â”‚   â”‚   â””â”€â”€ template.ts
â”‚   â”œâ”€â”€ utils/           # å·¥å…·å‡½æ•°
â”‚   â”‚   â”œâ”€â”€ chart.ts
â”‚   â”‚   â”œâ”€â”€ format.ts
â”‚   â”‚   â””â”€â”€ validation.ts
â”‚   â”œâ”€â”€ types/           # TypeScriptç±»å‹å®šä¹‰
â”‚   â”‚   â”œâ”€â”€ api.ts
â”‚   â”‚   â”œâ”€â”€ chart.ts
â”‚   â”‚   â””â”€â”€ user.ts
â”‚   â”œâ”€â”€ App.vue
â”‚   â””â”€â”€ main.ts
â”œâ”€â”€ package.json
â”œâ”€â”€ vite.config.ts
â”œâ”€â”€ tsconfig.json
â””â”€â”€ tailwind.config.js
```

### 3. æ ¸å¿ƒä¾èµ–åŒ…

#### package.json
```json
{
  "name": "universal-visualization-frontend",
  "version": "2.0.0",
  "type": "module",
  "scripts": {
    "dev": "vite",
    "build": "vue-tsc && vite build",
    "preview": "vite preview",
    "lint": "eslint . --ext .vue,.js,.jsx,.cjs,.mjs,.ts,.tsx,.cts,.mts --fix",
    "type-check": "vue-tsc --noEmit"
  },
  "dependencies": {
    "vue": "^3.3.8",
    "vue-router": "^4.2.5",
    "pinia": "^2.1.7",
    "axios": "^1.6.2",
    "element-plus": "^2.4.4",
    "@element-plus/icons-vue": "^2.1.0",
    "echarts": "^5.4.3",
    "vue-echarts": "^6.6.1",
    "plotly.js": "^2.27.0",
    "vue-demi": "^0.14.6"
  },
  "devDependencies": {
    "@vitejs/plugin-vue": "^4.5.0",
    "@vue/tsconfig": "^0.4.0",
    "typescript": "^5.2.2",
    "vue-tsc": "^1.8.22",
    "vite": "^5.0.0",
    "tailwindcss": "^3.3.6",
    "autoprefixer": "^10.4.16",
    "postcss": "^8.4.32",
    "@typescript-eslint/eslint-plugin": "^6.12.0",
    "@typescript-eslint/parser": "^6.12.0",
    "eslint": "^8.54.0",
    "eslint-plugin-vue": "^9.18.1"
  }
}
```

### 4. æ ¸å¿ƒç»„ä»¶è®¾è®¡

#### APIæœåŠ¡å±‚
```typescript
// src/api/visualization.ts
import axios from 'axios'
import type { VisualizationRequest, VisualizationResponse } from '@/types/api'

const api = axios.create({
  baseURL: import.meta.env.VITE_API_BASE_URL || 'http://localhost:8000',
  timeout: 30000
})

export const visualizationApi = {
  // ç”Ÿæˆå¯è§†åŒ–
  async generate(data: VisualizationRequest): Promise<VisualizationResponse> {
    const response = await api.post('/api/v2/generate', data)
    return response.data
  },

  // è·å–ç”ŸæˆçŠ¶æ€
  async getStatus(generationId: string): Promise<GenerationStatus> {
    const response = await api.get(`/api/v2/status/${generationId}`)
    return response.data
  },

  // è·å–å¯è§†åŒ–ç»“æœ
  async getVisualization(vizId: string): Promise<string> {
    const response = await api.get(`/api/v2/visualizations/${vizId}`)
    return response.data
  }
}
```

#### çŠ¶æ€ç®¡ç†
```typescript
// src/stores/visualization.ts
import { defineStore } from 'pinia'
import { ref, computed } from 'vue'
import type { VisualizationRequest, Visualization } from '@/types'
import { visualizationApi } from '@/api/visualization'

export const useVisualizationStore = defineStore('visualization', () => {
  // çŠ¶æ€
  const visualizations = ref<Visualization[]>([])
  const currentViz = ref<Visualization | null>(null)
  const loading = ref(false)
  const error = ref<string | null>(null)

  // è®¡ç®—å±æ€§
  const vizCount = computed(() => visualizations.value.length)
  const hasError = computed(() => error.value !== null)

  // æ–¹æ³•
  async function generateVisualization(request: VisualizationRequest) {
    loading.value = true
    error.value = null

    try {
      const response = await visualizationApi.generate(request)

      // è½®è¯¢çŠ¶æ€
      const pollStatus = setInterval(async () => {
        const status = await visualizationApi.getStatus(response.generation_id)

        if (status.status === 'completed') {
          clearInterval(pollStatus)
          const vizContent = await visualizationApi.getVisualization(status.html_url)

          const newViz: Visualization = {
            id: response.generation_id,
            title: request.prompt,
            content: vizContent,
            createdAt: new Date(),
            template: request.template_id
          }

          visualizations.value.unshift(newViz)
          currentViz.value = newViz
          loading.value = false
        } else if (status.status === 'failed') {
          clearInterval(pollStatus)
          error.value = status.error || 'ç”Ÿæˆå¤±è´¥'
          loading.value = false
        }
      }, 1000)

    } catch (err) {
      error.value = err instanceof Error ? err.message : 'æœªçŸ¥é”™è¯¯'
      loading.value = false
    }
  }

  function setCurrentVisualization(viz: Visualization) {
    currentViz.value = viz
  }

  function deleteVisualization(id: string) {
    const index = visualizations.value.findIndex(v => v.id === id)
    if (index > -1) {
      visualizations.value.splice(index, 1)
      if (currentViz.value?.id === id) {
        currentViz.value = null
      }
    }
  }

  return {
    // çŠ¶æ€
    visualizations,
    currentViz,
    loading,
    error,

    // è®¡ç®—å±æ€§
    vizCount,
    hasError,

    // æ–¹æ³•
    generateVisualization,
    setCurrentVisualization,
    deleteVisualization
  }
})
```

#### å›¾è¡¨ç»„ä»¶
```vue
<!-- src/components/charts/PlotlyChart.vue -->
<template>
  <div ref="chartContainer" class="chart-container"></div>
</template>

<script setup lang="ts">
import { ref, onMounted, watch } from 'vue'
import Plotly from 'plotly.js-dist'
import type { PlotlyData } from '@/types/chart'

interface Props {
  data: PlotlyData[]
  layout?: any
  config?: any
}

const props = withDefaults(defineProps<Props>(), {
  layout: () => ({}),
  config: () => ({ responsive: true })
})

const chartContainer = ref<HTMLElement>()

function renderChart() {
  if (!chartContainer.value) return

  const defaultLayout = {
    title: props.layout.title || '',
    xaxis: {
      title: props.layout.xaxis?.title || 'Xè½´',
      gridcolor: '#e0e0e0'
    },
    yaxis: {
      title: props.layout.yaxis?.title || 'Yè½´',
      gridcolor: '#e0e0e0'
    },
    plot_bgcolor: '#f8f9fa',
    paper_bgcolor: 'white',
    font: {
      family: 'Arial, sans-serif',
      size: 12
    },
    margin: { l: 50, r: 30, t: 50, b: 50 },
    ...props.layout
  }

  Plotly.newPlot(chartContainer.value, props.data, defaultLayout, props.config)
}

onMounted(() => {
  renderChart()
})

watch(() => props.data, () => {
  renderChart()
}, { deep: true })
</script>

<style scoped>
.chart-container {
  width: 100%;
  height: 100%;
  min-height: 400px;
}
</style>
```

### 5. é¡µé¢ç»„ä»¶è®¾è®¡

#### ä¸»ç¼–è¾‘å™¨é¡µé¢
```vue
<!-- src/views/Editor.vue -->
<template>
  <div class="editor-container">
    <!-- é¡¶éƒ¨å·¥å…·æ  -->
    <div class="toolbar">
      <el-button type="primary" @click="generateVisualization" :loading="loading">
        ç”Ÿæˆå¯è§†åŒ–
      </el-button>
      <el-button @click="saveToGallery">ä¿å­˜åˆ°å›¾åº“</el-button>
      <el-button @click="exportImage">å¯¼å‡ºå›¾ç‰‡</el-button>
    </div>

    <!-- ä¸»è¦å†…å®¹åŒº -->
    <div class="main-content">
      <!-- å·¦ä¾§é…ç½®é¢æ¿ -->
      <div class="config-panel">
        <el-tabs v-model="activeTab">
          <el-tab-pane label="åŸºç¡€é…ç½®" name="basic">
            <el-form :model="formData" label-width="100px">
              <el-form-item label="æè¿°">
                <el-input
                  v-model="formData.prompt"
                  type="textarea"
                  :rows="4"
                  placeholder="æè¿°æ‚¨æƒ³è¦ç”Ÿæˆçš„å¯è§†åŒ–..."
                />
              </el-form-item>

              <el-form-item label="æ¨¡æ¿">
                <el-select v-model="formData.template_id" placeholder="é€‰æ‹©æ¨¡æ¿">
                  <el-option
                    v-for="template in templates"
                    :key="template.id"
                    :label="template.name"
                    :value="template.id"
                  />
                </el-select>
              </el-form-item>
            </el-form>
          </el-tab-pane>

          <el-tab-pane label="é«˜çº§å‚æ•°" name="advanced">
            <component
              :is="templateConfigComponent"
              v-if="formData.template_id"
              v-model="formData.parameters"
            />
            <div v-else class="no-template-selected">
              è¯·å…ˆé€‰æ‹©ä¸€ä¸ªæ¨¡æ¿
            </div>
          </el-tab-pane>
        </el-tabs>
      </div>

      <!-- å³ä¾§é¢„è§ˆåŒº -->
      <div class="preview-panel">
        <div v-if="loading" class="loading-container">
          <el-loading-directive />
          <p>æ­£åœ¨ç”Ÿæˆå¯è§†åŒ–...</p>
        </div>

        <div v-else-if="error" class="error-container">
          <el-alert
            title="ç”Ÿæˆå¤±è´¥"
            :description="error"
            type="error"
            show-icon
            :closable="false"
          />
        </div>

        <div v-else-if="currentViz" class="visualization-container">
          <iframe
            :srcdoc="currentViz.content"
            class="viz-iframe"
            sandbox="allow-scripts allow-same-origin"
          />
        </div>

        <div v-else class="empty-state">
          <el-empty description="é…ç½®å®Œæˆåç‚¹å‡»ç”Ÿæˆå¯è§†åŒ–" />
        </div>
      </div>
    </div>
  </div>
</template>

<script setup lang="ts">
import { ref, computed, watch } from 'vue'
import { useVisualizationStore } from '@/stores/visualization'
import { useTemplateStore } from '@/stores/template'
import type { VisualizationRequest } from '@/types'

const vizStore = useVisualizationStore()
const templateStore = useTemplateStore()

// å“åº”å¼æ•°æ®
const activeTab = ref('basic')
const formData = ref<VisualizationRequest>({
  prompt: '',
  template_id: '',
  parameters: {},
  user_preferences: {}
})

// è®¡ç®—å±æ€§
const loading = computed(() => vizStore.loading)
const error = computed(() => vizStore.error)
const currentViz = computed(() => vizStore.currentViz)
const templates = computed(() => templateStore.templates)
const templateConfigComponent = computed(() => {
  if (!formData.value.template_id) return null
  return templateStore.getTemplateConfigComponent(formData.value.template_id)
})

// æ–¹æ³•
async function generateVisualization() {
  if (!formData.value.prompt.trim()) {
    ElMessage.warning('è¯·è¾“å…¥æè¿°')
    return
  }

  await vizStore.generateVisualization(formData.value)
}

function saveToGallery() {
  if (!currentViz.value) return
  // ä¿å­˜åˆ°å›¾åº“é€»è¾‘
}

function exportImage() {
  if (!currentViz.value) return
  // å¯¼å‡ºå›¾ç‰‡é€»è¾‘
}

// ç”Ÿå‘½å‘¨æœŸ
onMounted(() => {
  templateStore.loadTemplates()
})
</script>

<style scoped>
.editor-container {
  height: 100vh;
  display: flex;
  flex-direction: column;
}

.toolbar {
  height: 60px;
  display: flex;
  align-items: center;
  padding: 0 20px;
  border-bottom: 1px solid #e0e0e0;
  gap: 10px;
}

.main-content {
  flex: 1;
  display: flex;
  overflow: hidden;
}

.config-panel {
  width: 350px;
  border-right: 1px solid #e0e0e0;
  padding: 20px;
  overflow-y: auto;
}

.preview-panel {
  flex: 1;
  padding: 20px;
  overflow: hidden;
  display: flex;
  flex-direction: column;
}

.viz-iframe {
  width: 100%;
  height: 100%;
  border: none;
  border-radius: 8px;
  box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
}

.loading-container,
.error-container,
.empty-state {
  height: 100%;
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
}

.no-template-selected {
  text-align: center;
  color: #999;
  padding: 40px 20px;
}
</style>
```

### 6. ç±»å‹å®šä¹‰

```typescript
// src/types/api.ts
export interface VisualizationRequest {
  prompt: string
  template_id?: string
  parameters?: Record<string, any>
  user_preferences?: Record<string, any>
}

export interface VisualizationResponse {
  generation_id: string
  status: 'processing' | 'completed' | 'failed'
  message: string
  estimated_time?: number
  html_url?: string
}

export interface GenerationStatus {
  generation_id: string
  status: 'processing' | 'completed' | 'failed'
  progress: number
  created_at: string
  html_url?: string
  error?: string
}

// src/types/chart.ts
export interface PlotlyData {
  x: number[]
  y: number[]
  type: string
  mode?: string
  name?: string
  line?: {
    color?: string
    width?: number
  }
  marker?: {
    color?: string
    size?: number
  }
}

// src/types/template.ts
export interface Template {
  id: string
  name: string
  description: string
  subject: string
  category: string
  difficulty: string
  parameters: TemplateParameter[]
  examples: string[]
}

export interface TemplateParameter {
  name: string
  type: 'number' | 'string' | 'boolean' | 'range'
  label: string
  description: string
  default: any
  min?: number
  max?: number
  step?: number
  options?: string[]
}
```

### 7. æ„å»ºé…ç½®

```typescript
// vite.config.ts
import { defineConfig } from 'vite'
import vue from '@vitejs/plugin-vue'
import { resolve } from 'path'

export default defineConfig({
  plugins: [vue()],
  resolve: {
    alias: {
      '@': resolve(__dirname, 'src')
    }
  },
  server: {
    port: 3000,
    proxy: {
      '/api': {
        target: 'http://localhost:8000',
        changeOrigin: true
      }
    }
  },
  build: {
    outDir: 'dist',
    assetsDir: 'assets',
    sourcemap: false,
    rollupOptions: {
      output: {
        manualChunks: {
          'vendor': ['vue', 'vue-router', 'pinia'],
          'charts': ['echarts', 'plotly.js'],
          'ui': ['element-plus']
        }
      }
    }
  }
})
```

## ğŸ¨ UI/UX è®¾è®¡å»ºè®®

### 1. è®¾è®¡ç³»ç»Ÿ
- **è‰²å½©æ–¹æ¡ˆ**ï¼šä¸»è‰²è°ƒè“è‰²ï¼Œå¼ºè°ƒè‰²æ©™è‰²
- **å­—ä½“ç³»ç»Ÿ**ï¼šSF Pro / Inter
- **é—´è·ç³»ç»Ÿ**ï¼š8pxåŸºå‡†ç½‘æ ¼
- **åœ†è§’è§„èŒƒ**ï¼š4px, 8px, 12px

### 2. å“åº”å¼è®¾è®¡
```scss
// æ–­ç‚¹è®¾ç½®
$breakpoints: (
  xs: 0,
  sm: 576px,
  md: 768px,
  lg: 992px,
  xl: 1200px,
  xxl: 1400px
);

// æ··åˆå™¨
@mixin respond-to($breakpoint) {
  @media (min-width: map-get($breakpoints, $breakpoint)) {
    @content;
  }
}
```

### 3. åŠ¨ç”»æ•ˆæœ
```css
/* è¿‡æ¸¡åŠ¨ç”» */
.fade-enter-active,
.fade-leave-active {
  transition: opacity 0.3s ease;
}

.fade-enter-from,
.fade-leave-to {
  opacity: 0;
}

/* åŠ è½½åŠ¨ç”» */
@keyframes pulse {
  0%, 100% {
    opacity: 1;
  }
  50% {
    opacity: 0.5;
  }
}

.loading-pulse {
  animation: pulse 1.5s ease-in-out infinite;
}
```

## ğŸ“± ç§»åŠ¨ç«¯é€‚é…

### 1. å“åº”å¼å¸ƒå±€
- ä½¿ç”¨CSS Gridå’ŒFlexbox
- ç§»åŠ¨ä¼˜å…ˆè®¾è®¡åŸåˆ™
- è§¦æ‘¸å‹å¥½çš„äº¤äº’è®¾è®¡

### 2. æ€§èƒ½ä¼˜åŒ–
- æ‡’åŠ è½½ç»„ä»¶
- è™šæ‹Ÿæ»šåŠ¨
- å›¾ç‰‡å‹ç¼©å’ŒWebPæ ¼å¼

---

**è¿™ä¸ªå‰ç«¯ç°ä»£åŒ–æ–¹æ¡ˆæä¾›ï¼š**
- âœ… ç°ä»£åŒ–æŠ€æœ¯æ ˆå’Œæœ€ä½³å®è·µ
- âœ… å®Œæ•´çš„ç±»å‹å®‰å…¨å’Œå¼€å‘ä½“éªŒ
- âœ… ç»„ä»¶åŒ–å’Œæ¨¡å—åŒ–æ¶æ„
- âœ… ä¼˜ç§€çš„æ€§èƒ½å’Œç”¨æˆ·ä½“éªŒ
- âœ… æ˜“äºç»´æŠ¤å’Œæ‰©å±•çš„ä»£ç ç»“æ„